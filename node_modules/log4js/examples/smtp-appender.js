//Note that smtp appender needs nodemailer to work.
//If you haven't got nodemailer installed, you'll get cryptic
//"cannot find module" errors when using the smtp appender
var log4js = require('../lib/log4js')
, log
, logmailer
, i = 0;
log4js.configure({
  "appenders": [
    {
      type: "console",
      category: "test"
    },
    {
      "type": "smtp",
      "recipients": "erhu65@gmail.com",
      "sendInterval": 1,
      "transport": "SMTP",
      "SMTP": {
        "host": "smtp.gmail.com",
        "secureConnection": true,
        "port": 465,
        "auth": {
          "user": "erhu65@gmail.com",
          "pass": "jfkdls999"
        },
        "debug": true
      },
      "category": "mailer"
    }
  ]
});
log = log4js.getLogger("test");
logmailer = log4js.getLogger("mailer");

function doTheLogging(x) {
    log.info("Logging something %d", x);
    if ( (x % 100) === 0) {
        logmailer.info("Logging something %d", x);
    }
}

for ( ; i < 5000; i++) {
    doTheLogging(i);
}
